module.exports=function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=17)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return function(e,t){this.message=e,this.extras=t}}();t.AppAuthError=o},function(e,t,r){"use strict";var o,n=(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),s=function(){return function(){}}();t.Requestor=s;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.xhr=function(e){var t=$.ajax(e);return new Promise(function(e,r){t.then(function(t,r,o){e(t)},function(e,t,o){r(new i.AppAuthError(o))})})},t}(s);t.JQueryRequestor=u;var a=function(e){function t(t){var r=e.call(this)||this;return r.promise=t,r}return n(t,e),t.prototype.xhr=function(e){return this.promise},t}(s);t.TestRequestor=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.parse=function(e,t){return t?this.parseQueryString(e.hash):this.parseQueryString(e.search)},e.prototype.parseQueryString=function(e){for(var t={},r=(e=e.trim().replace(/^(\?|#|&)/,"")).split("&"),o=0;o<r.length;o+=1){var n=r[o].split("=");if(n.length>=2){var i=decodeURIComponent(n.shift()),s=n.length>0?n.join("="):null;s&&(t[i]=decodeURIComponent(s))}}return t},e.prototype.stringify=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&e[r]&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")},e}();t.BasicQueryStringUtils=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(14),n=function(){function e(){this.listener=null}return e.prototype.setAuthorizationListener=function(e){this.listener=e},e.prototype.onAuthorizationComplete=function(e,t,r){this.listener&&this.listener(e,t,r)},e}();t.AuthorizationNotifier=n,t.BUILT_IN_PARAMETERS=["redirect_uri","client_id","response_type","state","scope"];var i=function(){function e(e,t){this.utils=e,this.generateRandom=t,this.notifier=null}return e.prototype.buildRequestUrl=function(e,r){var o={redirect_uri:r.redirectUri,client_id:r.clientId,response_type:r.responseType,state:r.state,scope:r.scope};if(r.extras)for(var n in r.extras)r.extras.hasOwnProperty(n)&&t.BUILT_IN_PARAMETERS.indexOf(n)<0&&(o[n]=r.extras[n]);var i=this.utils.stringify(o);return e.authorizationEndpoint+"?"+i},e.prototype.completeAuthorizationRequestIfPossible=function(){var e=this;return o.log("Checking to see if there is an authorization response to be delivered."),this.notifier||o.log("Notifier is not present on AuthorizationRequest handler.\n          No delivery of result will be possible"),this.completeAuthorizationRequest().then(function(t){t||o.log("No result is available yet."),t&&e.notifier&&e.notifier.onAuthorizationComplete(t.request,t.response,t.error)})},e.prototype.setAuthorizationNotifier=function(e){return this.notifier=e,this},e}();t.AuthorizationRequestHandler=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function n(e){for(var t=[],r=0;r<e.byteLength;r+=1){var n=e[r]%o.length|0;t.push(o[n])}return t.join("")}t.bufferToString=n;var i="undefined"!=typeof window&&!!window.crypto;t.cryptoGenerateRandom=function(e){void 0===e&&(e=1);var t=new Uint8Array(e);if(i)window.crypto.getRandomValues(t);else for(var r=0;r<e;r+=1)t[r]=Math.random();return n(t)}},function(e,t,r){"use strict";var o,n,i,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n=[],void 0===(i="function"==typeof(o=function(){var e=XMLHttpRequest;if(!e)throw new Error("missing XMLHttpRequest");function t(i,s){if("function"!=typeof s)throw new Error("Bad callback given: "+s);if(!i)throw new Error("No options given");var u=i.onResponse;if((i="string"==typeof i?{uri:i}:JSON.parse(JSON.stringify(i))).onResponse=u,i.verbose&&(t.log=function(){var e,t,r={},i=["trace","debug","info","warn","error"];for(t=0;t<i.length;t++)r[e=i[t]]=o,"undefined"!=typeof console&&console&&console[e]&&(r[e]=n(console,e));return r}()),i.url&&(i.uri=i.url,delete i.url),!i.uri&&""!==i.uri)throw new Error("options.uri is a required argument");if("string"!=typeof i.uri)throw new Error("options.uri must be a string");for(var a=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],c=0;c<a.length;c++)if(i[a[c]])throw new Error("options."+a[c]+" is not supported");if(i.callback=s,i.method=i.method||"GET",i.headers=i.headers||{},i.body=i.body||null,i.timeout=i.timeout||t.DEFAULT_TIMEOUT,i.headers.host)throw new Error("Options.headers.host is not supported");i.json&&(i.headers.accept=i.headers.accept||"application/json","GET"!==i.method&&(i.headers["content-type"]="application/json"),"boolean"!=typeof i.json?i.body=JSON.stringify(i.json):"string"!=typeof i.body&&(i.body=JSON.stringify(i.body)));var p=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")};if(i.qs){var f="string"==typeof i.qs?i.qs:p(i.qs);-1!==i.uri.indexOf("?")?i.uri=i.uri+"&"+f:i.uri=i.uri+"?"+f}if(i.form){if("string"==typeof i.form)throw"form name unsupported";if("POST"===i.method){var d=(i.encoding||"application/x-www-form-urlencoded").toLowerCase();switch(i.headers["content-type"]=d,d){case"application/x-www-form-urlencoded":i.body=p(i.form).replace(/%20/g,"+");break;case"multipart/form-data":var h=function(e){var t={};t.boundry="-------------------------------"+Math.floor(1e9*Math.random());var r=[];for(var o in e)e.hasOwnProperty(o)&&r.push("--"+t.boundry+'\nContent-Disposition: form-data; name="'+o+'"\n\n'+e[o]+"\n");return r.push("--"+t.boundry+"--"),t.body=r.join(""),t.length=t.body.length,t.type="multipart/form-data; boundary="+t.boundry,t}(i.form);i.body=h.body,i.headers["content-type"]=h.type;break;default:throw new Error("unsupported encoding:"+d)}}}return i.onResponse=i.onResponse||o,!0===i.onResponse&&(i.onResponse=s,i.callback=o),!i.headers.authorization&&i.auth&&(i.headers.authorization="Basic "+function(e){var t,r,o,n,i,s,u,a,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p=0,f=0,d="",h=[];if(!e)return e;do{t=e.charCodeAt(p++),r=e.charCodeAt(p++),o=e.charCodeAt(p++),n=(a=t<<16|r<<8|o)>>18&63,i=a>>12&63,s=a>>6&63,u=63&a,h[f++]=c.charAt(n)+c.charAt(i)+c.charAt(s)+c.charAt(u)}while(p<e.length);switch(d=h.join(""),e.length%3){case 1:d=d.slice(0,-2)+"==";break;case 2:d=d.slice(0,-1)+"="}return d}(i.auth.username+":"+i.auth.password)),function(o){var n=new e,i=!1,s=function(e){var t,r=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{t=location.href}catch(e){(t=document.createElement("a")).href="",t=t.href}var o=r.exec(t.toLowerCase())||[],n=r.exec(e.toLowerCase());return!(!n||n[1]==o[1]&&n[2]==o[2]&&(n[3]||("http:"===n[1]?80:443))==(o[3]||("http:"===o[1]?80:443)))}(o.uri),u="withCredentials"in n;if(r+=1,n.seq_id=r,n.id=r+": "+o.method+" "+o.uri,n._id=n.id,s&&!u){var a=new Error("Browser does not support cross-origin request: "+o.uri);return a.cors="unsupported",o.callback(a,n)}n.timeoutTimer=setTimeout(function(){i=!0;var e=new Error("ETIMEDOUT");return e.code="ETIMEDOUT",e.duration=o.timeout,t.log.error("Timeout",{id:n._id,milliseconds:o.timeout}),o.callback(e,n)},o.timeout);var c={response:!1,loading:!1,end:!1};return n.onreadystatechange=function(r){if(i)return t.log.debug("Ignoring timed out state change",{state:n.readyState,id:n.id});if(t.log.debug("State change",{state:n.readyState,id:n.id,timed_out:i}),n.readyState===e.OPENED)for(var s in t.log.debug("Request started",{id:n.id}),o.headers)n.setRequestHeader(s,o.headers[s]);else n.readyState===e.HEADERS_RECEIVED?p():n.readyState===e.LOADING?(p(),f()):n.readyState===e.DONE&&(p(),f(),function(){if(!c.end){if(c.end=!0,t.log.debug("Request done",{id:n.id}),n.body=n.responseText,o.json)try{n.body=JSON.parse(n.responseText)}catch(e){return o.callback(e,n)}o.callback(null,n,n.body)}}())},n.open(o.method,o.uri,!0),s&&(n.withCredentials=!!o.withCredentials),n.send(o.body),n;function p(){if(!c.response){if(c.response=!0,t.log.debug("Got response",{id:n.id,status:n.status}),clearTimeout(n.timeoutTimer),n.statusCode=n.status,s&&0==n.statusCode){var e=new Error("CORS request rejected: "+o.uri);return e.cors="rejected",c.loading=!0,c.end=!0,o.callback(e,n)}o.onResponse(null,n)}}function f(){c.loading||(c.loading=!0,t.log.debug("Response body loading",{id:n.id}))}}(i)}t.log={trace:o,debug:o,info:o,warn:o,error:o};var r=0;function o(){}function n(e,t){return function(r,o){return"object"===(void 0===o?"undefined":s(o))&&(r+=" "+JSON.stringify(o)),e[t].call(e,r)}}return t.withCredentials=!1,t.DEFAULT_TIMEOUT=18e4,t.defaults=function(e,r){var o=function(t){return function(r,o){for(var n in r="string"==typeof r?{uri:r}:JSON.parse(JSON.stringify(r)),e)void 0===r[n]&&(r[n]=e[n]);return t(r,o)}},n=o(t);return n.get=o(t.get),n.post=o(t.post),n.put=o(t.put),n.head=o(t.head),n},["get","put","post","head"].forEach(function(e){var r=e.toUpperCase();t[e.toLowerCase()]=function(e){"string"==typeof e?e={method:r,uri:e}:(e=JSON.parse(JSON.stringify(e))).method=r;var o=[e].concat(Array.prototype.slice.apply(arguments,[1]));return t.apply(this,o)}}),t.couch=function(e,r){return"string"==typeof e&&(e={uri:e}),e.json=!0,e.body&&(e.json=e.body),delete e.body,r=r||o,t(e,function(e,t,o){if(e)return r(e,t,o);if((t.statusCode<200||t.statusCode>299)&&o.error){for(var n in e=new Error("CouchDB error: "+(o.error.reason||o.error.error)),o)e[n]=o[n];return r(e,t,o)}return r(e,t,o)})},t})?o.apply(t,n):o)||(e.exports=i)},function(e,t,r){"use strict";var o,n=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),s=r(1),u=r(5),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.xhr=function(e){return new Promise(function(t,r){u({form:e.data,headers:e.headers,json:"json"===e.dataType||void 0,method:e.method,url:e.url},function(e,o,n){200!==o.statusCode?r(new i.AppAuthError(o.statusMessage)):t(n)})})},t}(s.Requestor);t.WebviewRequestor=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.open=function(e){window.SafariViewController.isAvailable(function(t){t?window.SafariViewController.show({url:e,enterReaderModeIfAvailable:!0}):window.open(e)})},e}();t.Agent=o},function(e,t,r){"use strict";var o,n=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(3),s=r(4),u=r(2),a=r(7),c=function(e){function t(t,r){void 0===t&&(t=new u.BasicQueryStringUtils),void 0===r&&(r=s.cryptoGenerateRandom);var o=e.call(this,t,r)||this;return o.authorizationPromise=null,o}return n(t,e),t.prototype.performAuthorizationRequest=function(e,t){var r=this;this.authorizationPromise=new Promise(function(o,n){a.Agent.open(r.buildRequestUrl(e,t))})},t.prototype.completeAuthorizationRequest=function(){return this.authorizationPromise?this.authorizationPromise:Promise.reject("No pending authorization request. Call performAuthorizationRequest() ?")},t}(i.AuthorizationRequestHandler);t.ViewControllerRequestHandler=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GRANT_TYPE_AUTHORIZATION_CODE="authorization_code",t.GRANT_TYPE_REFRESH_TOKEN="refresh_token";var o=function(){function e(e,t,r,o,n,i){this.clientId=e,this.redirectUri=t,this.grantType=r,this.code=o,this.refreshToken=n,this.extras=i}return e.prototype.toJson=function(){return{grant_type:this.grantType,code:this.code,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,client_id:this.clientId,extras:this.extras}},e.prototype.toStringMap=function(){var e={grant_type:this.grantType,client_id:this.clientId,redirect_uri:this.redirectUri};if(this.code&&(e.code=this.code),this.refreshToken&&(e.refresh_token=this.refreshToken),this.extras)for(var t in this.extras)this.extras.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=this.extras[t]);return e},e.fromJson=function(t){return new e(t.client_id,t.redirect_uri,t.grant_type,t.code,t.refresh_token,t.extras)},e}();t.TokenRequest=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return Math.round((new Date).getTime()/1e3)},n=function(){function e(e,t,r,n,i,s,u){void 0===i&&(i="bearer"),void 0===s&&(s=o()),this.accessToken=e,this.idToken=t,this.refreshToken=r,this.scope=n,this.tokenType=i,this.issuedAt=s,this.expiresIn=u}return e.prototype.toJson=function(){return{access_token:this.accessToken,id_token:this.idToken,refresh_token:this.refreshToken,scope:this.scope,token_type:this.tokenType,issued_at:this.issuedAt,expires_in:this.expiresIn}},e.prototype.isValid=function(){return!this.expiresIn||o()<this.issuedAt+this.expiresIn},e.fromJson=function(t){var r=t.issued_at?t.issued_at:o();return new e(t.access_token,t.id_token,t.refresh_token,t.scope,t.token_type,r,t.expires_in)},e}();t.TokenResponse=n;var i=function(){function e(e,t,r){this.error=e,this.errorDescription=t,this.errorUri=r}return e.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri}},e.fromJson=function(t){return new e(t.error,t.error_description,t.error_uri)},e}();t.TokenError=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),n=r(2),i=r(10),s=r(1),u=function(){function e(e,t){void 0===e&&(e=new s.JQueryRequestor),void 0===t&&(t=new n.BasicQueryStringUtils),this.requestor=e,this.utils=t}return e.prototype.isTokenResponse=function(e){return void 0===e.error},e.prototype.performRevokeTokenRequest=function(e,t){return this.requestor.xhr({url:e.revocationEndpoint,method:"POST",dataType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:t.toJson()}).then(function(e){return!0})},e.prototype.performTokenRequest=function(e,t){var r=this;return this.requestor.xhr({url:e.tokenEndpoint,method:"POST",dataType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(t.toStringMap())}).then(function(e){return r.isTokenResponse(e)?i.TokenResponse.fromJson(e):Promise.reject(new o.AppAuthError(e.error,i.TokenError.fromJson(e)))})},e}();t.BaseTokenRequestHandler=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),n=function(){function e(e,t,r,o,n){this.authorizationEndpoint=e,this.tokenEndpoint=t,this.revocationEndpoint=r,this.endSessionEndpoint=o,this.userInfoEndpoint=n}return e.prototype.toJson=function(){return{authorization_endpoint:this.authorizationEndpoint,token_endpoint:this.tokenEndpoint,revocation_endpoint:this.revocationEndpoint,end_session_endpoint:this.endSessionEndpoint,userinfo_endpoint:this.userInfoEndpoint}},e.fromJson=function(t){return new e(t.authorization_endpoint,t.token_endpoint,t.revocation_endpoint,t.end_session_endpoint,t.userinfo_endpoint)},e.fetchFromIssuer=function(t,r){var n=t+"/.well-known/openid-configuration";return(r||new o.JQueryRequestor).xhr({url:n,dataType:"json"}).then(function(t){return e.fromJson(t)})},e}();t.AuthorizationServiceConfiguration=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IS_LOG=!0,t.IS_PROFILE=!1},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(13);function n(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];o.IS_LOG&&((t?t.length:0)>0?console.log.apply(console,[e].concat(t)):console.log(e))}t.log=n;var i="undefined"!=typeof window&&!!window.performance&&!!console.profile;t.profile=function(e,t,r){return o.IS_PROFILE?function(e,t,r){var o=r.value,s=o.name;return s||(s="anonymous function"),r.value=i?function(e){console.profile(s);var t=window.performance.now(),r=o.call.apply(o,[this||window].concat(e)),n=window.performance.now()-t;return console.log(s+" took "+n+" ms"),console.profileEnd(),r}:function(e){n("Profile start "+s);var t=Date.now(),r=o.call.apply(o,[this||window].concat(e)),i=Date.now()-t;return n("Profile end "+s+" took "+i+" ms."),r},r}(0,0,r):r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(4),n=function(e){return e(10)},i=function(){function e(t,r,i,s,u,a,c){void 0===s&&(s=e.RESPONSE_TYPE_CODE),void 0===c&&(c=o.cryptoGenerateRandom),this.clientId=t,this.redirectUri=r,this.scope=i,this.responseType=s,this.extras=a,this.state=u||n(c)}return e.prototype.toJson=function(){return{response_type:this.responseType,client_id:this.clientId,redirect_uri:this.redirectUri,scope:this.scope,state:this.state,extras:this.extras}},e.fromJson=function(t){return new e(t.client_id,t.redirect_uri,t.scope,t.response_type,t.state,t.extras)},e.RESPONSE_TYPE_CODE="code",e}();t.AuthorizationRequest=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),n=r(15),i=r(3),s=r(12),u=r(11),a=(r(9),r(8));var c=new(r(6).WebviewRequestor),p=function(){function e(t){var r=t.issuerUrl,o=t.redirectUri,n=t.clientId,s=t.scopes;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="OIDClient",this.issuerUrl=r,this.redirectUri=o,this.clientId=n,this.scopes=s,this.notifier=new i.AuthorizationNotifier,this.tokenHandler=new u.BaseTokenRequestHandler(c),this.authorizationHandler=new a.ViewControllerRequestHandler,this.authorizationHandler.setAuthorizationNotifier(this.notifier),this.notifier.setAuthorizationListener(function(e,t,r){console.log("Authorization request complete ",e,t,r)})}return o(e,[{key:"fetchServiceConfiguration",value:function(){var e=this;return s.AuthorizationServiceConfiguration.fetchFromIssuer(this.issuerUrl,c).then(function(t){return console.log("Fetched service configuration",t),e.configuration=t,e.configuration})}},{key:"makeAuthorizationRequest",value:function(){var e=new n.AuthorizationRequest(this.clientId,this.redirectUri,this.scope,n.AuthorizationRequest.RESPONSE_TYPE_CODE,"state",{prompt:"consent",access_type:"offline"});console.log("Making authorization request ",this.configuration,e),this.authorizationHandler.performAuthorizationRequest(this.configuration,e)}}]),e}();t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OIDCClient=void 0;var o,n=r(16),i=(o=n)&&o.__esModule?o:{default:o};t.OIDCClient=i.default}]);